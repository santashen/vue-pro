<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>我的旅行地图</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      padding-top: 70px;
      background: linear-gradient(to bottom right, #e0f7fa, #fce4ec);
      min-height: 100vh;
      font-family: 'Helvetica Neue', sans-serif;
    }
    #map {
      height: 80vh;
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }
    footer {
      text-align: center;
      padding: 10px;
      font-size: 0.9rem;
      color: #777;
    }
    .content-section {
      animation: fadeIn 0.3s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .readme-container {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
      max-width: 900px;
      margin: 0 auto;
    }
    .readme-container h1 {
      color: #2c3e50;
      border-bottom: 3px solid #3498db;
      padding-bottom: 0.5rem;
      margin-bottom: 1.5rem;
    }
    .readme-container h2 {
      color: #34495e;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    .readme-container h3 {
      color: #7f8c8d;
      margin-top: 1.5rem;
      margin-bottom: 0.8rem;
    }
    .readme-container pre {
      background: #f8f9fa;
      padding: 1rem;
      border-radius: 5px;
      border-left: 4px solid #3498db;
      overflow-x: auto;
    }
    .readme-container code {
      background: #f8f9fa;
      padding: 0.2rem 0.4rem;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
    .readme-container ul, .readme-container ol {
      padding-left: 2rem;
    }
    .readme-container li {
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>

  <!-- 导航栏 -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">🌏 我的旅行地图</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarContent">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="#" onclick="showContent('map')">地图</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showContent('readme')">项目说明</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 页面内容 -->
  <div class="container mt-4">
    <!-- 地图页面 -->
    <div id="map-content" class="content-section">
      <h2 class="text-center mb-4">🗺️ 我去过的地方</h2>
      <div id="map" class="border shadow-sm"></div>
    </div>
    
    <!-- README说明页面 -->
    <div id="readme-content" class="content-section" style="display: none;">
      <div class="readme-container">
        <h1>🌏 My Travel 旅行地图项目</h1>
        
        <h2>📖 项目简介</h2>
        <p>这是一个静态HTML项目，使用Leaflet.js地图库展示个人旅行足迹。项目包含一个互动地图，标记了作者访问过的各个城市，并附有相应的旅行回忆和评论。</p>
        
        <h2>✨ 项目特点</h2>
        <ul>
          <li>📍 <strong>互动地图</strong>：基于OpenStreetMap的地图展示</li>
          <li>🐧 <strong>自定义标记</strong>：使用可爱的企鹅图标作为地点标记</li>
          <li>💬 <strong>旅行回忆</strong>：每个地点都包含个人的旅行感受和回忆</li>
          <li>📱 <strong>响应式设计</strong>：使用Bootstrap框架，支持移动端访问</li>
          <li>🎨 <strong>美观界面</strong>：渐变背景和现代化UI设计</li>
        </ul>
        
        <h2>🛠️ 技术栈</h2>
        <ul>
          <li><strong>前端</strong>：HTML5, CSS3, JavaScript</li>
          <li><strong>地图库</strong>：Leaflet.js</li>
          <li><strong>UI框架</strong>：Bootstrap 5.3.3</li>
          <li><strong>地图服务</strong>：OpenStreetMap</li>
          <li><strong>Web服务器</strong>：Nginx（静态文件服务）</li>
        </ul>
        
        <h2>🗂️ 文件结构</h2>
        <pre><code>my_travel/
├── app.html           # 主页面文件
├── penguin.png        # 地图标记图标
├── places.json        # 地点数据文件
├── nginx-travel.conf  # Nginx配置文件
└── README.md         # 项目说明文件</code></pre>
        
        <h2>📊 数据格式</h2>
        <p><code>places.json</code> 文件格式：</p>
        <pre><code>[
  {
    "name": "城市名称",
    "lat": 纬度,
    "lon": 经度,
    "comment": "旅行回忆和评论"
  }
]</code></pre>
        
        <h2>🔧 维护说明</h2>
        <h3>添加新地点</h3>
        <p>编辑 <code>places.json</code> 文件，添加新的地点对象即可。</p>
        
        <h3>自定义样式</h3>
        <p>可以修改页面中的CSS样式来调整外观。</p>
        
        <h3>更换地图标记</h3>
        <p>替换 <code>penguin.png</code> 文件可以更换地图标记图标，建议使用32x32像素的PNG图片。</p>
        
        <h2>⚠️ 注意事项</h2>
        <ol>
          <li>由于使用的是静态文件，无需数据库或后端服务</li>
          <li>地点数据存储在JSON文件中，修改后需要重新部署</li>
          <li>确保服务器有足够的带宽处理地图加载请求</li>
          <li>如果需要添加大量地点，建议考虑性能优化</li>
        </ol>
        
        <div class="alert alert-info mt-4">
          <h4>💡 使用提示</h4>
          <p>点击地图上的企鹅图标可以查看每个地点的详细旅行回忆。地图支持缩放和拖拽操作，您可以自由探索所有标记的地点。</p>
        </div>
      </div>
    </div>
  </div>

  <!-- 页脚 -->
  <footer class="mt-4">
    © 2025 我的旅行日志 ｜ Powered by Leaflet & Bootstrap
  </footer>

  <!-- 脚本 -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // 页面切换功能
    function showContent(contentType) {
      // 隐藏所有内容区域
      document.getElementById('map-content').style.display = 'none';
      document.getElementById('readme-content').style.display = 'none';
      
      // 移除所有导航项的active类
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
      });
      
      // 显示选中的内容区域
      if (contentType === 'map') {
        document.getElementById('map-content').style.display = 'block';
        // 如果地图还没有初始化，初始化地图
        if (!window.mapInitialized) {
          initializeMap();
        }
      } else if (contentType === 'readme') {
        document.getElementById('readme-content').style.display = 'block';
      }
      
      // 添加active类到当前导航项
      event.target.classList.add('active');
    }
    
    // 地图初始化函数
    function initializeMap() {
      const myIcon = L.icon({
        iconUrl: 'penguin.png',
        iconSize: [32, 32],
        iconAnchor: [16, 32],
        popupAnchor: [0, -32]
      });

      const map = L.map('map').setView([37, 120], 4);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '地图数据 &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> 贡献者',
        maxZoom: 18,
      }).addTo(map);

      fetch('places.json')
        .then(response => response.json())
        .then(data => {
          data.forEach(place => {
            L.marker([place.lat, place.lon], {icon: myIcon})
              .addTo(map)
              .bindPopup(`<b>${place.name}</b><br>${place.comment}`);
          });
        })
        .catch(error => console.error("加载 JSON 出错:", error));
      
      window.mapInitialized = true;
    }
    
    // 页面加载完成后初始化地图
    document.addEventListener('DOMContentLoaded', function() {
      initializeMap();
    });
  </script>
</body>
</html>
